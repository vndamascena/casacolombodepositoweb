<nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #ffffff; margin-bottom: 0px; padding: 0px;">



    <div class="container">


        <a class="navbar-brand" href="consulta-produtos">
            <img src="/assets/CASA COLOMBO.jpg" alt="Logo" style="width: 200px; height: auto;">

        </a>
        <div class="container">
            <h1 class="titulo">Pisos e Revestimentos</h1>
            <div class="input-group mb-3 barra-pesquisa">
                <input type="text" class="form-control lupa" placeholder="Digite o nome do produto"
                    aria-label="Pesquisar" aria-describedby="basic-addon1" [(ngModel)]="expression"
                    (input)="filtrarProdutos()">
                <div class="overlay" (click)="filtrarProdutos()"></div>
            </div>
        </div>


        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link black-text" routerLink="/consulta-produtos">
                        <img src="/assets/2.png" alt="Ícone de Consulta" width="125" height="125">
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link black-text" routerLink="/cadastrar-produtos">
                        <img src="/assets/2.2.png" alt="Ícone de Cadastro" width="125" height="125">
                    </a>
                </li>

            </ul>
        </div>

    </div>
</nav>
<div class="line"></div>
<br>


<div class="container mt-4">
    <h2>Histórico de Vendas</h2>
    <div class="row mb-2 align-items-end">
        <div class="col-md-2">
            <label for="startDate">Data Inicial:</label>
            <input type="date" id="startDate" class="form-control" [(ngModel)]="startDate">
        </div>
        <div class="col-md-2">
            <label for="endDate">Data Final:</label>
            <input type="date" id="endDate" class="form-control" [(ngModel)]="endDate">
        </div>
        <div class="col-md-2">
            <button class="btn btn-primary" (click)="filterData()">Filtrar</button>
        </div>
    </div>
</div>
<div class="table-responsive">
    <table class="table table-bordered table-hover">
        <!-- cabeçalho da tabela -->
        <thead>
            <tr>
                <th>Usuario</th>
                <th style="color: #07612b; font-weight: bold;">Qtd caixas vendidas</th>
                <th>Detalhes</th>
                
                
            </tr>
        </thead>
        <!-- Corpo da tabela -->

        <tbody>
            <ng-container *ngFor="let vendaAgrupada of vendas">
              <tr>
                <td>{{ vendaAgrupada.usuarioId }}</td>
                <td style="color: #07612b; font-weight: bold;">
                  {{ vendaAgrupada.vendas.length }} Vendas
                </td>
                <td>
                  <button class="btn btn-outline-success" (click)="toggleDetalhesUsuario(vendaAgrupada)">+</button>
                </td>
              </tr>
              <tr *ngIf="vendaAgrupada.mostrarDetalhes">
                <td colspan="13">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Produto</th>
                        <th>Código</th>
                        <th>Número do Lote</th>
                        <th style="color: #07612b; font-weight: bold;">Quantidade vendida</th>
                        <th>Data vendida</th>
                      </tr>
                    </thead>
                    <tbody>
                      <ng-container *ngFor="let venda of vendaAgrupada.vendas">
                        <tr>
                          <td>{{ venda.nomeProduto }}</td>
                          <td>{{ venda.codigo }}</td>
                          <td>{{ venda.numeroLote }}</td>
                          <td>{{ venda.quantidade }}</td>
                          <td>{{ venda.dataVenda | date: 'dd/MM/yyyy' }}</td>
                        </tr>
                      </ng-container>
                    </tbody>
                  </table>
                </td>
              </tr>
            </ng-container>
          </tbody>
        <!-- rodapé da tabela -->
    </table>
    <tfoot>
        <tr>
            <td colspan="14">
                Quantidade usuarios: {{ vendas.length  }}
            </td>
        </tr>
    </tfoot>
</div>