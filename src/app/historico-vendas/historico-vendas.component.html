<nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #ffffff; margin-bottom: 0px; padding: 12px;">
  <div class="container mt-3">
    <a class="navbar-brand" href="inicio">
      <img src="/assets/cplg.png" alt="Logo" style="width: 200px; height: auto;">
    </a>
    <div class="container">
      <h1 class="titulo"><strong>Pisos e Revestimentos</strong></h1>
      <div class="input-group mb-3 barra-pesquisa">
        <input type="text" class="form-control lupa" placeholder="Digite o nome do produto" aria-label="Pesquisar"
          aria-describedby="basic-addon1" [(ngModel)]="expression" (input)="filtrarPisoData()">
        <i class=" bi-trash-fill	btn-clear" (click)="limparPesquisa()"></i>
        <div class="overlay" (click)="filtrarProdutos()"></div>
      </div>
      <div>

        <div class="row mb-2 justify-content-center text-center">
          <div class="col-md-6 d-flex justify-content-center align-items-center gap-3">


            <div class="d-flex flex-column">
              <input id="dataInicio" type="date" class="form-control" [(ngModel)]="dataVendaInicio"
                (change)="filtrarPisoData()">
            </div>


            <div class="d-flex flex-column">
              <input id="dataFim" type="date" class="form-control" [(ngModel)]="dataVendaFim"
                (change)="filtrarPisoData()">
            </div>


            <div class="form-check ms-3">
              <input type="checkbox" class="form-check-input" [(ngModel)]="filtroSaida" (change)="filtrarPisoData()"
                style="background-color: rgb(216, 62, 62); transform: scale(1.5);">
            </div>


            <div class="form-check">
              <input type="checkbox" class="form-check-input" [(ngModel)]="filtroEntrada" (change)="filtrarPisoData()"
                style="background-color: rgb(8, 0, 244); transform: scale(1.5);">
            </div>

          </div>
        </div>


      </div>
    </div>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link black-text" routerLink="/consulta-produtos">
            <img src="/assets/2.png" alt="Ícone de Consulta" width="110" height="110">
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link black-text" routerLink="/cadastrar-produtos">
            <img src="/assets/2.2.png" alt="Ícone de Cadastro" width="110" height="110">
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link black-text" routerLink="/historico-vendas">
            <img src="/assets/1.jpg" alt="Ícone de Consulta" width="110" height="110">
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="line container mt-3"></div>


<div class="table-responsive container mt-3">




  <table class="table">

    <thead>
      <tr>
        <th>Usuário</th>
        <th>Nome do Produto</th>
        <th>Marca</th>
        <th>Código</th>
        <th>Número do Lote</th>
        <th>Quantidade</th>
        <th>Data</th>
      </tr>
    </thead>

    <tbody>
      <ng-container *ngFor="let item of dadosFiltrados | paginate: { itemsPerPage: 10, currentPage: p }">
        <tr>
          <td [ngStyle]="{'color': item.tipo === 'dataVenda' ? 'red' : 'blue'}">{{ item.nome }}</td>
          <td [ngStyle]="{'color': item.tipo === 'dataVenda' ? 'red' : 'blue'}">{{ item.nomeProduto }}</td>
          <td [ngStyle]="{'color': item.tipo === 'dataVenda' ? 'red' : 'blue'}">{{item.marca}}</td>
          <td [ngStyle]="{'color': item.tipo === 'dataVenda' ? 'red' : 'blue'}">{{ item.codigo }}</td>
          <td [ngStyle]="{'color': item.tipo === 'dataVenda' ? 'red' : 'blue'}">{{ item.numeroLote }}</td>
          <td [ngStyle]="{'color': item.tipo === 'dataVenda' ? 'red' : 'blue'}">{{ item.quantidade || item.qtdEntrada }}
          </td>
          <td [ngStyle]="{'color': item.tipo === 'dataVenda' ? 'red' : 'blue'}">{{ item.dataVenda ? (item.dataVenda |
            date:'dd/MM/yyyy') : (item.dataEntrada | date:'dd/MM/yyyy') }}</td>
        </tr>
      </ng-container>
    </tbody>
  </table>

  <tfoot>
    <tr>
      <td colspan="14">

        <!-- SE filtroEntrada for ativado E filtroSaida for desativado — MOSTRAR SÓ ENTRADA -->
        <ng-container *ngIf="filtroEntrada && !filtroSaida">
          <strong>
            Entradas: {{ totalEntradaFiltrada }} de {{ totalEntradaGeral }}
          </strong>
        </ng-container>

        <!-- SE filtroSaida for ativado E filtroEntrada for desativado — MOSTRAR SÓ VENDAS -->
        <ng-container *ngIf="filtroSaida && !filtroEntrada">
          <strong>
            Vendidos: {{ totalVendidoFiltrado }} de {{ totalVendidoGeral }}
          </strong>
        </ng-container>

        <!-- SE AMBOS filtros ativados → mostra ENTRADA e VENDIDA -->
        <ng-container *ngIf="filtroEntrada && filtroSaida">
          <strong>
            Entradas: {{ totalVendidoFiltrado }} de {{ totalVendidoGeral }}
          </strong>
          <br>
          <strong>
            Entradas: {{ totalEntradaFiltrada }} de {{ totalEntradaGeral }}
          </strong>
        </ng-container>

        <!-- SE NENHUM filtro estiver ativado → mostrar só VENDAS -->
        <ng-container *ngIf="!filtroEntrada && !filtroSaida">
          <strong>
            Vendidos: {{ totalVendidoFiltrado }} de {{ totalVendidoGeral }}
          </strong>
        </ng-container>

      </td>
    </tr>
  </tfoot>



</div>

<div class="col text-center">
  <strong>
    <pagination-controls (pageChange)="p = $event" previousLabel="Anterior" nextLabel="Próximo"></pagination-controls>
  </strong>
</div>